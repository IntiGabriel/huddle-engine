<template name="searchIndex">
  <div class="container">

    <div class="page-header">
      <h1>Search <small>for Evidence</small></h1>
    </div>

    <div id="deviceIndicatorWrapper" style="{{thisDeviceBorderColorCSS}}">
      {{#each otherDevices}}
        <span deviceid="{{id}}" class="deviceIndicator" style="{{deviceSizePositionCSS}} {{deviceBackgroundColorCSS}}"></span>
      {{/each}}
    </div>

    <div class="row">
      <div class="col-md-10 col-md-offset-1 input-group">
        <!--<span id="search-query-wrapper">
          <span id="search-tag-wrapper"></span>-->
          <input id="search-query" type="text" placeholder="Search..." autocomplete="off" />
        <!--</span>-->
        <span class="input-group-btn">
          <button type="button" id="search-btn" class="btn btn-primary">
            <span class="glyphicon glyphicon-search"></span> Search</button>
        </span>
      </div>
    </div>

    <div class="row">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{#each querySuggestions}}
          <a href="#" class="querySuggestion">{{query}}</a><br />
        {{/each}}
      </div>
    </div>

    <div class="row result-info">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{#with results}}
          Found {{hits.total}} results <!-- ({{toSeconds took}} seconds) -->
        {{/with}}
      </div>
    </div>

    {{#each results.hits.hits}}
      <div class="row document-result">
        <div class="col-md-10 col-md-offset-1">
        {{#if isFavorited}}
          <img src="/images/star_enabled.png" class="favoritedStar icon"/>
        {{else}}
          <img src="/images/star_disabled.png" class="favoritedStar icon"/>
        {{/if}}

        {{#if hasComment}}
          <img src="/images/comment.png" class="icon"/>
        {{/if}}

        {{#if wasWatched}}
          <img src="/images/watched.png" class="icon"/>
        {{/if}}
          <h4>
            <a href="#" class="hit">{{_id}}</a> (<a href="{{urlToDocument _id}}" target="_blank">raw document</a>)
          </h4>
          <ul>
            {{#each highlight.file}}
              <li class="document-highlight" documentid="{{../_id}}">{{{this}}}</li>
            {{/each}}
          </ul>
        </div>
      </div>
    {{/each}}
  </div> <!-- container -->

  <div id="documentDetails">
    {{#with detailDocument}}
      {{#if highlightDocumentContent}}
          <div id="contentArea">
            <div id="contentWrapper">
              <pre id="textContent">{{{highlightDocumentContent}}}</pre>

              <pre class="textSelectionWrapper" style="top: -{{detailDocumentScrollOffset}}px;" id="selectedSnippetHighlight">{{{highlightDocumentSelectedSnippetContent}}}</pre>

            {{#if highlightDocumentContent}}
              {{#each detailDocumentHighlights}}
                <pre class="textSelectionWrapper" style="top: -{{detailDocumentScrollOffset}}px;">{{{detailDocumentHighlightContent this}}}</pre>
              {{/each}}
              {{/if}}
            </div>
         </div>

          <div id="editArea">
            <a class="textHighlighter" href="#" style="background-color: orange;"></a>
            <a class="textHighlighter" href="#" style="background-color: red;"></a>
            <a class="textHighlighter" href="#" style="background-color: green;"></a>
            <a class="textHighlighter" href="#" style="background-color: blue;"></a>
            <a class="textHighlighter" href="#" style="background-color: purple;"></a>
            <a class="textHighlighter" href="#" style="background-color: slategray;"></a>
            <a class="textHighlighter" href="#" style="background-color: sienna;"></a>
            
            <a href="#" id="deleteHighlights">
            {{#if detailDocumentSelectedHighlightsCount}}
              Delete {{detailDocumentSelectedHighlightsCount}} {{pluralize detailDocumentSelectedHighlightsCount 'highlight' 'highlights'}}
            {{/if}}
            </a>

            Send to: 
            <select id="devicedropdown">
              <option>Select device</option>
              {{#each otherDevices}}
                <option style="{{deviceBackgroundColorCSS}}" deviceid="{{id}}">Device</option>
              {{/each}}
            </select>
            <br />



            <img src="/images/star_{{#if isFavorited}}enabled{{else}}disabled{{/if}}.png" style="width: 32px;" class="favoritedStar icon" id="detailDocumentStar"/>

            <textarea rows="4" cols="50" id="comment">{{comment}}</textarea>
            <button id="saveCommentButton">Save</button>
          </div>
        {{/if}}
      {{/with}}
    </div> <!-- documentPopup -->
</template>
