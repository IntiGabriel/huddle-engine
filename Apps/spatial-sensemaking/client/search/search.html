<template name="searchIndex">

  {{> handlebarsCSS}}
  
  {{> deviceIndicators}}

  {{> deviceWorldView}}

  <!-- <div class="container"> -->

    <div class="page-header">
      <h1>Search <small>for Evidence</small></h1>
    </div>

    <div class="row">
      <div class="col-md-10 col-md-offset-1 input-group">
        <!--<span id="search-query-wrapper">
          <span id="search-tag-wrapper"></span>-->
          <input id="search-query" type="text" placeholder="Search..." autocomplete="off" />
        <!--</span>-->
        <span class="input-group-btn">
          <button type="button" id="search-btn" class="btn btn-primary">
            <span class="glyphicon glyphicon-search"></span> Search</button>
        </span>
      </div>
    </div>

    <div class="row">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{#each querySuggestions}}
          <a href="#" class="querySuggestion">{{query}}</a><br />
        {{/each}}
      </div>
    </div>

    <div class="row result-info">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{#with results}}
          Found {{hits.total}} results <!-- ({{toSeconds took}} seconds) -->
        {{/with}}
      </div>
    </div>

    <div class="row result-info">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{> pagination}}
      </div>
    </div>

    {{#each results.hits.hits}}
      <div class="row document-result">
        <div class="col-md-10 col-md-offset-1">
          <a href="#" class="toggleFavorited"><span class="glyphicon glyphicon-{{#if isFavorited}}heart{{else}}heart-empty{{/if}} icon"></span>
          </a>

        {{#if hasComment}}
          <span class="glyphicon glyphicon-tags icon"></span>
        {{/if}}

        {{#if wasWatched}}
          <span class="glyphicon glyphicon-eye-open icon"></span>
        {{/if}}
          <h4>
            <a href="#" class="hit">{{_id}}</a> (<a href="{{urlToDocument _id}}" target="_blank">raw document</a>)
          </h4>
          <ul>
            {{#each highlight.file}}
              <li class="document-highlight" documentid="{{../_id}}">{{{this}}}</li>
            {{/each}}
          </ul>
        </div>
      </div>
    {{/each}}

    <div class="row result-info">
      <div class="col-md-10 col-md-offset-1 input-group">
        {{> pagination}}
      </div>
    </div>
  <!-- </div> container -->

  {{> detailDocumentTemplate}}
</template>

<template name="pagination">
  {{#each pages}}
    {{#if isEqual this currentPage}}
      <span class="paginationLink active">{{currentPage}}</span>
    {{else}}
      <a href="#" query="{{currentQuery}}" page='{{this}}' class='paginationLink'>{{this}}</a>
    {{/if}}
  {{/each}}
</template>